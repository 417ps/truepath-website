<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network & Server-Side Logo Diagnostics</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        h1, h2 {
            text-align: center;
            margin-bottom: 30px;
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .test-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .test-card h3 {
            margin-top: 0;
            color: #FFD700;
            border-bottom: 2px solid #FFD700;
            padding-bottom: 10px;
        }

        .logo-display {
            text-align: center;
            margin: 15px 0;
            min-height: 80px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            border: 2px dashed #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-display img {
            max-height: 60px;
            max-width: 100%;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-loading { background: orange; }
        .status-success { background: #4CAF50; }
        .status-error { background: #f44336; }

        .network-info {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }

        .test-results {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
        }

        .protocol-test {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            margin: 5px;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
        }

        .error-log {
            background: #2d1b1b;
            border: 1px solid #d32f2f;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            color: #ffcdd2;
            font-family: monospace;
            font-size: 12px;
        }

        .path-test {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }

        .mime-info {
            background: rgba(76, 175, 80, 0.2);
            border-left: 4px solid #4CAF50;
            padding: 10px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåê Network & Server-Side Logo Diagnostics</h1>
        <p style="text-align: center; font-size: 18px; margin-bottom: 40px;">
            Comprehensive testing to identify network requests, protocol limitations, and server-side issues
        </p>

        <div class="test-grid">
            <!-- Test 1: Current Implementation -->
            <div class="test-card">
                <h3>üîç Test 1: Current Logo Implementation</h3>
                <div class="logo-display" id="current-logo-display">
                    <img src="../assets/logos/truepath-logo-horizontal.svg" alt="Current SVG" 
                         id="current-logo" onload="markSuccess('current')" onerror="markError('current')">
                </div>
                <div class="network-info" id="current-info">Loading current implementation...</div>
            </div>

            <!-- Test 2: Alternative Paths -->
            <div class="test-card">
                <h3>üóÇÔ∏è Test 2: Alternative Path Testing</h3>
                <div class="logo-display" id="alt-path-display">
                    <img src="/assets/logos/truepath-logo-horizontal.svg" alt="Absolute Path SVG"
                         id="alt-path-logo" onload="markSuccess('alt-path')" onerror="markError('alt-path')">
                </div>
                <div class="network-info" id="alt-path-info">Testing absolute path...</div>
            </div>

            <!-- Test 3: PNG Fallback -->
            <div class="test-card">
                <h3>üñºÔ∏è Test 3: PNG Fallback Test</h3>
                <div class="logo-display" id="png-fallback-display">
                    <img src="../assets/logos/logo-horizontal-white.png" alt="PNG Fallback"
                         id="png-fallback" onload="markSuccess('png-fallback')" onerror="markError('png-fallback')">
                </div>
                <div class="network-info" id="png-fallback-info">Testing PNG fallback...</div>
            </div>

            <!-- Test 4: Object Embed -->
            <div class="test-card">
                <h3>üìé Test 4: Object Embed Method</h3>
                <div class="logo-display" id="object-embed-display">
                    <object data="../assets/logos/truepath-logo-horizontal.svg" type="image/svg+xml" 
                            style="height: 60px;" id="object-embed">
                        <img src="../assets/logos/logo-horizontal-white.png" alt="Object Fallback" style="height: 60px;">
                    </object>
                </div>
                <div class="network-info" id="object-embed-info">Testing object embed method...</div>
            </div>
        </div>

        <!-- Protocol & CORS Tests -->
        <div class="test-results">
            <h2>üî¨ Protocol & Network Analysis</h2>
            
            <div class="protocol-test">
                <span class="status-indicator status-loading" id="protocol-status"></span>
                <span id="protocol-info">Detecting protocol: <span id="current-protocol">...</span></span>
            </div>

            <div class="protocol-test">
                <span class="status-indicator status-loading" id="cors-status"></span>
                <span id="cors-info">CORS Policy Check: <span id="cors-result">Testing...</span></span>
            </div>

            <div class="protocol-test">
                <span class="status-indicator status-loading" id="mime-status"></span>
                <span id="mime-info">MIME Type Detection: <span id="mime-result">Checking...</span></span>
            </div>

            <div class="protocol-test">
                <span class="status-indicator status-loading" id="fetch-status"></span>
                <span id="fetch-info">Fetch API Test: <span id="fetch-result">Testing...</span></span>
            </div>
        </div>

        <!-- Path Resolution Tests -->
        <div class="test-results">
            <h2>üìÅ Path Resolution Analysis</h2>
            <div class="path-test">
                <h4>Current Directory Analysis:</h4>
                <div class="network-info" id="path-analysis">Analyzing paths...</div>
            </div>
            
            <div class="path-test">
                <h4>Alternative Serving Methods:</h4>
                <button onclick="testDataURI()">Test Data URI</button>
                <button onclick="testBlob()">Test Blob URL</button>
                <button onclick="testInlineSVG()">Test Inline SVG</button>
                <div class="logo-display" id="alternative-display" style="margin-top: 15px;"></div>
            </div>
        </div>

        <!-- Network Request Details -->
        <div class="test-results">
            <h2>üì° Network Request Details</h2>
            <div class="network-info" id="network-details">Gathering network information...</div>
            <button onclick="performDetailedNetworkTest()">Run Detailed Network Test</button>
        </div>

        <!-- Error Console -->
        <div class="test-results">
            <h2>üö® Error Console</h2>
            <div class="error-log" id="error-console">No errors detected yet...</div>
        </div>
    </div>

    <script>
        // Global error tracking
        const errors = [];
        const networkTests = {};

        // Override console.error to capture errors
        const originalError = console.error;
        console.error = function(...args) {
            originalError.apply(console, args);
            errors.push(args.join(' '));
            updateErrorConsole();
        };

        function updateErrorConsole() {
            const errorDiv = document.getElementById('error-console');
            if (errors.length === 0) {
                errorDiv.textContent = 'No errors detected yet...';
            } else {
                errorDiv.innerHTML = errors.map(error => `<div style="margin: 5px 0; padding: 5px; background: rgba(255,0,0,0.1); border-radius: 4px;">${error}</div>`).join('');
            }
        }

        function markSuccess(testId) {
            networkTests[testId] = 'success';
            document.getElementById(`${testId}-info`).textContent = '‚úÖ Image loaded successfully';
            console.log(`${testId} test: SUCCESS`);
        }

        function markError(testId) {
            networkTests[testId] = 'error';
            const errorMsg = '‚ùå Failed to load image';
            document.getElementById(`${testId}-info`).textContent = errorMsg;
            console.error(`${testId} test: FAILED`);
            errors.push(`${testId} image load failed`);
            updateErrorConsole();
        }

        // Protocol detection
        function detectProtocol() {
            const protocol = window.location.protocol;
            document.getElementById('current-protocol').textContent = protocol;
            document.getElementById('protocol-status').className = 'status-indicator status-success';
            
            if (protocol === 'file:') {
                document.getElementById('protocol-info').innerHTML += '<br><strong style="color: #FFD700;">‚ö†Ô∏è FILE PROTOCOL DETECTED</strong><br>This may cause issues with external resource loading.';
            }
        }

        // CORS testing
        function testCORS() {
            fetch('../assets/logos/truepath-logo-horizontal.svg', { mode: 'cors' })
                .then(response => {
                    document.getElementById('cors-result').textContent = `‚úÖ CORS OK (${response.status})`;
                    document.getElementById('cors-status').className = 'status-indicator status-success';
                })
                .catch(error => {
                    document.getElementById('cors-result').textContent = `‚ùå CORS Error: ${error.message}`;
                    document.getElementById('cors-status').className = 'status-indicator status-error';
                    errors.push(`CORS error: ${error.message}`);
                    updateErrorConsole();
                });
        }

        // MIME type detection
        function testMIME() {
            fetch('../assets/logos/truepath-logo-horizontal.svg')
                .then(response => {
                    const contentType = response.headers.get('content-type');
                    document.getElementById('mime-result').textContent = contentType || 'Not specified';
                    document.getElementById('mime-status').className = 'status-indicator status-success';
                    
                    if (!contentType || !contentType.includes('svg')) {
                        document.getElementById('mime-info').innerHTML += '<br><strong style="color: orange;">‚ö†Ô∏è Incorrect MIME type detected</strong>';
                    }
                })
                .catch(error => {
                    document.getElementById('mime-result').textContent = `Error: ${error.message}`;
                    document.getElementById('mime-status').className = 'status-indicator status-error';
                });
        }

        // Fetch API test
        function testFetch() {
            fetch('../assets/logos/truepath-logo-horizontal.svg')
                .then(response => {
                    if (response.ok) {
                        document.getElementById('fetch-result').textContent = `‚úÖ Fetch successful (${response.status})`;
                        document.getElementById('fetch-status').className = 'status-indicator status-success';
                        return response.text();
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                })
                .then(svgText => {
                    document.getElementById('fetch-info').innerHTML += `<br>SVG content length: ${svgText.length} characters`;
                })
                .catch(error => {
                    document.getElementById('fetch-result').textContent = `‚ùå Fetch failed: ${error.message}`;
                    document.getElementById('fetch-status').className = 'status-indicator status-error';
                    errors.push(`Fetch failed: ${error.message}`);
                    updateErrorConsole();
                });
        }

        // Path analysis
        function analyzePaths() {
            const baseURL = window.location.href;
            const pathInfo = `
Current page URL: ${baseURL}
Base directory: ${baseURL.substring(0, baseURL.lastIndexOf('/'))}
Relative path resolves to: ${new URL('../assets/logos/', baseURL).href}
Absolute path would be: ${new URL('/assets/logos/', baseURL).href}

Testing different path formats:
‚Ä¢ ../assets/logos/truepath-logo-horizontal.svg
‚Ä¢ /assets/logos/truepath-logo-horizontal.svg  
‚Ä¢ ./assets/logos/truepath-logo-horizontal.svg
‚Ä¢ assets/logos/truepath-logo-horizontal.svg
            `;
            document.getElementById('path-analysis').textContent = pathInfo;
        }

        // Alternative serving methods
        function testDataURI() {
            fetch('../assets/logos/truepath-logo-horizontal.svg')
                .then(response => response.text())
                .then(svgText => {
                    const dataURI = 'data:image/svg+xml;base64,' + btoa(svgText);
                    const img = document.createElement('img');
                    img.src = dataURI;
                    img.style.height = '60px';
                    img.onload = () => console.log('Data URI test: SUCCESS');
                    img.onerror = () => console.error('Data URI test: FAILED');
                    
                    const display = document.getElementById('alternative-display');
                    display.innerHTML = '<h5>Data URI Result:</h5>';
                    display.appendChild(img);
                })
                .catch(error => {
                    console.error('Data URI test failed:', error);
                    errors.push(`Data URI test failed: ${error.message}`);
                    updateErrorConsole();
                });
        }

        function testBlob() {
            fetch('../assets/logos/truepath-logo-horizontal.svg')
                .then(response => response.blob())
                .then(blob => {
                    const blobURL = URL.createObjectURL(blob);
                    const img = document.createElement('img');
                    img.src = blobURL;
                    img.style.height = '60px';
                    img.onload = () => {
                        console.log('Blob URL test: SUCCESS');
                        URL.revokeObjectURL(blobURL); // Clean up
                    };
                    img.onerror = () => console.error('Blob URL test: FAILED');
                    
                    const display = document.getElementById('alternative-display');
                    display.innerHTML = '<h5>Blob URL Result:</h5>';
                    display.appendChild(img);
                })
                .catch(error => {
                    console.error('Blob URL test failed:', error);
                    errors.push(`Blob URL test failed: ${error.message}`);
                    updateErrorConsole();
                });
        }

        function testInlineSVG() {
            fetch('../assets/logos/truepath-logo-horizontal.svg')
                .then(response => response.text())
                .then(svgText => {
                    const display = document.getElementById('alternative-display');
                    display.innerHTML = '<h5>Inline SVG Result:</h5>' + svgText;
                    console.log('Inline SVG test: SUCCESS');
                })
                .catch(error => {
                    console.error('Inline SVG test failed:', error);
                    errors.push(`Inline SVG test failed: ${error.message}`);
                    updateErrorConsole();
                });
        }

        // Detailed network test
        function performDetailedNetworkTest() {
            const detailsDiv = document.getElementById('network-details');
            detailsDiv.innerHTML = 'Running detailed network analysis...\n\n';

            // Test multiple paths
            const testPaths = [
                '../assets/logos/truepath-logo-horizontal.svg',
                '/assets/logos/truepath-logo-horizontal.svg',
                './assets/logos/truepath-logo-horizontal.svg',
                'assets/logos/truepath-logo-horizontal.svg'
            ];

            testPaths.forEach((path, index) => {
                fetch(path)
                    .then(response => {
                        detailsDiv.innerHTML += `Path ${index + 1} (${path}): ‚úÖ ${response.status} ${response.statusText}\n`;
                        detailsDiv.innerHTML += `  Headers: ${JSON.stringify(Object.fromEntries(response.headers), null, 2)}\n\n`;
                    })
                    .catch(error => {
                        detailsDiv.innerHTML += `Path ${index + 1} (${path}): ‚ùå ${error.message}\n\n`;
                        errors.push(`Path test ${index + 1} failed: ${error.message}`);
                        updateErrorConsole();
                    });
            });

            // Network timing
            const startTime = performance.now();
            fetch('../assets/logos/truepath-logo-horizontal.svg')
                .then(response => {
                    const endTime = performance.now();
                    detailsDiv.innerHTML += `\nNetwork timing: ${(endTime - startTime).toFixed(2)}ms\n`;
                    detailsDiv.innerHTML += `Response size: ${response.headers.get('content-length') || 'Unknown'} bytes\n`;
                })
                .catch(error => {
                    detailsDiv.innerHTML += `\nTiming test failed: ${error.message}\n`;
                });
        }

        // Initialize tests
        window.addEventListener('load', function() {
            console.log('Page loaded, starting diagnostics...');
            
            // Run protocol and network tests
            setTimeout(() => {
                detectProtocol();
                testCORS();
                testMIME();
                testFetch();
                analyzePaths();
            }, 1000);

            // Monitor loading of test images
            setTimeout(() => {
                console.log('Network test results:', networkTests);
                
                // Generate summary
                const successCount = Object.values(networkTests).filter(result => result === 'success').length;
                const errorCount = Object.values(networkTests).filter(result => result === 'error').length;
                
                console.log(`Summary: ${successCount} successful, ${errorCount} failed`);
                
                if (errorCount > 0) {
                    console.error('Some logo loading tests failed. Check the error console above for details.');
                }
            }, 3000);
        });

        // Capture any unhandled errors
        window.addEventListener('error', function(event) {
            errors.push(`Unhandled error: ${event.error?.message || event.message}`);
            updateErrorConsole();
        });
    </script>
</body>
</html>